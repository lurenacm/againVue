{"version":3,"file":"vue.js","sources":["../../src/observer/arrayMethods.js","../../src/observer/index.js","../../src/state.js","../../src/compile/parser.js","../../src/compile/generate.js","../../src/compile/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["// 重写数组的 push pop shift unshift reverse sort splice 因为这几个常用方法可以改变原数组\r\n\r\nimport {\r\n    observerArray\r\n} from \"./index\"\r\n\r\n/**继承数组的原型，没有重写的方法使用原型链上的原方法 */\r\nconst oldArrayMethods = Array.prototype\r\nlet arrayMethods = Object.create(oldArrayMethods)\r\n\r\nconst methods = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function (...args) {\r\n        // this 指向的是 (vm.arrs.push ) arrs 这个数组，\r\n        // 需要添加 this 指向调用的对象不然，原型上的 push 没有调用的主体\r\n        let res = oldArrayMethods[method].call(this, ...args)\r\n\r\n        // 为了监控数组添加的数据类型也是一个 object push({}, {}) \r\n        // 需要再次进行数组劫持添加 definedPrototype\r\n        let instead;\r\n        let ob = this.__ob__\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                instead = args\r\n                break;\r\n            case 'splice':\r\n                instead = args;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (instead) ob.observerArray(instead)\r\n        return res\r\n    }\r\n})\r\n\r\nfunction push() {\r\n    push()\r\n}\r\n\r\nexport {\r\n    arrayMethods\r\n}","// 使用 Object.definedProperty 重新给data 属性添加 get/set 实现响应式的变化\r\n\r\nimport {\r\n    arrayMethods\r\n} from './arrayMethods';\r\n\r\n/** Observer 就是来添加 get/set 的 class */\r\nclass Observer {\r\n    constructor(value) {\r\n        // vue 不监控数组的每一项，因为性能消耗很大\r\n        // 通过操作数组的索引转变成操作数组的方法。\r\n        Object.defineProperty(value, '__ob__', {\r\n            enumerable: false,\r\n            configurable: false,\r\n            value: this\r\n        })\r\n\r\n        if (Array.isArray(value)) {\r\n            value.__proto__ = arrayMethods \r\n            this.observerArray(value)\r\n        } else {\r\n            this.walk(value) // 对对象的属性进行添加get/set\r\n        }\r\n    }\r\n\r\n    // 数组劫持\r\n    observerArray(arr) { // arr: [{},{}]\r\n    // 监控数组中的对象和数组类型，再次递归，性能消耗大\r\n        arr.forEach(item => {\r\n            observer(item)\r\n        }) \r\n        \r\n    }\r\n\r\n    // 对象劫持\r\n    walk(data) {\r\n        let keys = Object.keys(data) //keys = [name, age, attr]\r\n        keys.forEach(key => {\r\n            definedReactive(data, key, data[key])\r\n        })\r\n    }\r\n}\r\n\r\nfunction definedReactive(data, key, value) {\r\n    observer(value)\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) return\r\n            // 这里再次使用递归考虑到属性的赋值可能是一个对象。\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n\r\n/** 递归实现 给对象的属性添加`get/set` */\r\nexport function observer(data) {\r\n    if (typeof data === 'object' && data !== null) {\r\n        return new Observer(data)\r\n    }\r\n}","// 初始化 props data computed watch 等属性\r\nimport {\r\n    observer\r\n} from './observer/index'\r\n\r\nexport function initState(vm) {\r\n    let opts = vm.$options\r\n    if (opts.props) {\r\n        initPros(vm)\r\n    }\r\n    if (opts.methods) {\r\n        initMethods(vm)\r\n    }\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n    if (opts.computed) {\r\n        initComputed(vm)\r\n    }\r\n    if (opts.watch) {\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initPros() {}\r\n\r\nfunction initMethods() {}\r\n\r\n/** vm._data 是为了保证可以访问到data(data假如是函数)属性的值 */\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n    //响应式原理 数据劫持：劫持data对象的数据，使用 Object.definedProperty() 添加 get/set 方法\r\n\r\n    // 改变访问的方式 vm._data. === vm.  做一层代理\r\n    for (const key in data) {\r\n        proxy(vm, key)\r\n    }\r\n\r\n    observer(data)\r\n}\r\n\r\nfunction proxy(vm, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm['_data'][key]\r\n        },\r\n        set(newVal) {\r\n            return vm['_data'][key] = newVal\r\n        }\r\n    })\r\n}\r\n\r\n\r\nfunction initComputed() {}\r\n\r\nfunction initWatch() {}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\n// html -> ast -> render() \r\n\r\n// 使用栈来构建 ast 语法树（dom树）\r\nfunction creatAstElement(tagName, attrs) {\r\n    return {\r\n        tag: tagName,\r\n        type: 1,\r\n        attrs,\r\n        children: [],\r\n        parent: null,\r\n\r\n    }\r\n}\r\n\r\nlet root = null\r\nlet stack = []\r\n\r\nfunction start(tagName, attrs) {\r\n    let parent = stack[stack.length -1]\r\n    let element = creatAstElement(tagName, attrs)\r\n    if (!root) {\r\n        root = element\r\n    }\r\n    element.parent = parent\r\n    if(element.parent) {\r\n        element.parent.children.push(element)\r\n    }\r\n    stack.push(element)\r\n}\r\n\r\nfunction end(tagName) {\r\n    let last = stack.pop()\r\n    if(last.tag !== tagName){\r\n        throw new Error()\r\n    }\r\n}\r\n\r\nfunction chars(text) {\r\n    text = text.replace(/\\s/g, \"\")\r\n    let parent = stack[stack.length -1]\r\n    if(text) {\r\n        parent.children.push({\r\n            type: 3,\r\n            text\r\n        })\r\n    }\r\n}\r\n\r\nexport function parseHTML(html) {\r\n    while (html) {\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {\r\n            const startTagMatch = parseStartTag();\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n            const endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n        }\r\n        let text;\r\n        if (textEnd >= 0) {\r\n            text = html.substring(0, textEnd);\r\n        }\r\n        if (text) {\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n    }\r\n\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n            let attr, end;\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length);\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3]\r\n                });\r\n            }\r\n            if (end) {\r\n                advance(end[0].length);\r\n                return match\r\n            }\r\n        }\r\n    }\r\n    return root\r\n}\r\n\r\n// example：<div id = \"#app\">{{msg}}</div>\r\n// vue2.x 中的模板编译使用正则表达式逐步匹配解析标签内属性和值。\r\n// 模板编译就是处理 {{msg}} 实现的内容。 \r\n","\r\nexport function generate(root) {\r\n    console.log('------', root)\r\n}","import {parseHTML} from './parser'\r\nimport { generate } from './generate';\r\n\r\n\r\nexport function compileToFunction(template) {\r\n   let root =  parseHTML(template);\r\n   generate(root)\r\n    // 创建虚拟 dom\r\n    // render()\r\n}","import { initState } from './state'\r\nimport {compileToFunction} from './compile/index'\r\n\r\nexport function initMixin(myVue) {\r\n    // 初始化流程\r\n    myVue.prototype._init = function (options) {\r\n        // 数据劫持，其他地方也需要使用\r\n        const vm = this\r\n        this.$options = options\r\n\r\n        // 初始化数据\r\n        initState(vm)\r\n\r\n        // 挂载模板\r\n        if (this.$options.el) {\r\n            vm.$mount(this.$options.el)\r\n        }\r\n    }\r\n\r\n    myVue.prototype.$mount = function (el) {\r\n        let vm = this\r\n        let options = vm.$options\r\n        el = document.querySelector(el)\r\n        if (!vm.render) {\r\n            if (!vm.template && el) {\r\n                let template = el.outerHTML\r\n                // console.log(template)\r\n                // 将模板 template 编译成虚拟 dom \r\n                let render = compileToFunction(template)\r\n                options.render = render\r\n            }\r\n        }\r\n    }\r\n\r\n}","import {initMixin} from './init'\r\nfunction myVue(options = {}){\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(myVue)\r\nexport default myVue"],"names":["oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","res","call","instead","ob","__ob__","observerArray","Observer","value","defineProperty","enumerable","configurable","isArray","__proto__","walk","arr","item","observer","data","keys","key","definedReactive","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","_data","proxy","newVal","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","creatAstElement","tagName","attrs","tag","type","children","parent","root","stack","start","length","element","push","end","last","pop","Error","chars","text","replace","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","generate","console","log","compileToFunction","template","initMixin","myVue","_init","options","el","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}